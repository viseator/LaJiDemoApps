package xyz.viseator.v2ex.http;import android.content.Context;import android.os.AsyncTask;import android.support.v7.widget.RecyclerView;import android.util.Log;import org.jsoup.Jsoup;import org.jsoup.helper.DescendableLinkedList;import org.jsoup.nodes.Document;import org.jsoup.nodes.Element;import org.jsoup.select.Elements;import java.io.IOException;import java.util.List;import xyz.viseator.v2ex.data.DetailContent;import xyz.viseator.v2ex.ui.DetailRecyclerViewAdapter;/** * Created by viseator on 2016/11/19. */public class GetHTMLMainContentTask extends AsyncTask<String, Void, Document> {    private List<DetailContent> detailContents;    private RecyclerView recyclerView;    private Context context;    private static final String TAG = "wudi GetHTML";    public GetHTMLMainContentTask(RecyclerView recyclerView, Context context) {        this.recyclerView = recyclerView;        this.context = context;    }    @Override    protected Document doInBackground(String... urls) {        Document doc;        try {            doc = Jsoup.connect(urls[0]).get();            return doc;        } catch (IOException e) {            e.printStackTrace();        }        return null;    }    @Override    protected void onPostExecute(Document document) {// TODO: 2016/11/19 Parse HTML and put result into detailContents        StringBuilder topicContent = new StringBuilder();        if (!document.select("div.topic_content:has(p)").isEmpty()) {            Elements mainContent = document.select("div.topic_content p");            if(!mainContent.hasText()) Log.d(TAG, "get nothing");            for (Element element : mainContent) {                topicContent.append(element.text());                topicContent.append("\n\n");            }        } else {            Elements mainContent = document.select("div.topic_content");            topicContent.append(mainContent.text());        }        DetailContent firstContent = new DetailContent();        firstContent.setContent(topicContent.toString());        detailContents = new DescendableLinkedList<>();        detailContents.add(firstContent);        recyclerView.setAdapter(new DetailRecyclerViewAdapter(context, detailContents));    }}