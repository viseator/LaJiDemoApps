package xyz.viseator.v2ex.http;import android.content.Context;import android.os.AsyncTask;import android.support.v7.widget.RecyclerView;import android.util.Log;import com.google.gson.Gson;import com.google.gson.reflect.TypeToken;import java.io.BufferedReader;import java.io.IOException;import java.io.InputStreamReader;import java.lang.reflect.Type;import java.net.URL;import java.util.List;import javax.net.ssl.HttpsURLConnection;import cn.bingoogolapple.refreshlayout.BGARefreshLayout;import xyz.viseator.v2ex.data.MainContent;import xyz.viseator.v2ex.ui.MainRecyclerViewAdapter;/** * Created by viseator on 2016/11/18. */public class GetListTask extends AsyncTask<URL, Void, String> {    private final static String TAG = "wudi GetListTask";    private Context context;    private RecyclerView recyclerView;    private BGARefreshLayout bgaRefreshLayout;    public GetListTask(Context context, RecyclerView recyclerView, BGARefreshLayout bgaRefreshLayout) {        this.bgaRefreshLayout = bgaRefreshLayout;        this.context = context;        this.recyclerView = recyclerView;    }    @Override    protected String doInBackground(URL... urls) {        HttpsURLConnection httpsURLConnection;        StringBuilder response = new StringBuilder();        try {            httpsURLConnection = (HttpsURLConnection) urls[0].openConnection();            int statusCode = httpsURLConnection.getResponseCode();            if (statusCode == 200) {                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(                        httpsURLConnection.getInputStream()));                String line;                while ((line = bufferedReader.readLine()) != null) {                    response.append(line);                }            }        } catch (IOException e) {            Log.e(TAG, "URL error");            e.printStackTrace();        }        return response.toString();    }    @Override    protected void onPostExecute(String response) {        Gson gson = new Gson();        Type theType = new TypeToken<List<MainContent>>() {        }.getType();        List<MainContent> myContentList = gson.fromJson(response, theType);        recyclerView.setAdapter(new MainRecyclerViewAdapter(context, myContentList));        bgaRefreshLayout.endRefreshing();    }}